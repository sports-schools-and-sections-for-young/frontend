{"version":3,"file":"SearchInput.stories-9c889da3.js","sources":["../../src/components/ui/SearchInput/SearchInput.tsx"],"sourcesContent":["import { forwardRef, useEffect, useRef, useState } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport styles from \"./SearchInput.module.scss\";\nimport InputLabel from \"../InputLabel/InputLabel.tsx\";\nimport InputField, { InputFieldProps } from \"../InputField/InputField.tsx\";\n\nexport interface SearchingItem {\n  id: number;\n  title: string;\n}\n\nexport interface SearchInputProps extends InputFieldProps {\n  labelName?: string;\n  searchingList: SearchingItem[];\n  itemClickHandler: (e: SearchingItem) => void;\n  hasFilter?: boolean;\n}\n\nconst SearchInput = forwardRef<HTMLInputElement, SearchInputProps>(\n  (props, ref) => {\n    const {\n      labelName = \"\",\n      hasError,\n      errorMessage,\n      searchingList,\n      itemClickHandler,\n      hasFilter = true,\n      ...rest\n    } = props;\n\n    const labelId = `label-${uuidv4()}`;\n\n    const [open, setOpen] = useState(false);\n\n    const [value, setValue] = useState(\"\");\n\n    const filteredList = hasFilter\n      ? searchingList\n          .filter((item) =>\n            item.title.toLowerCase().includes(String(value).toLowerCase()),\n          )\n          .sort((a, b) => (a.title > b.title ? 1 : -1))\n      : searchingList;\n\n    async function handleItemClick(\n      cb: (e: SearchingItem) => void,\n      value: SearchingItem,\n    ) {\n      await cb(value);\n      setValue(\"\");\n      setOpen(false);\n    }\n\n    const root = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n      const onClick = (e: MouseEvent) => {\n        if (\n          root &&\n          root.current &&\n          !root.current.contains(e.target as HTMLBodyElement)\n        ) {\n          setOpen(false);\n        }\n      };\n      document.addEventListener(\"click\", onClick);\n      return () => document.removeEventListener(\"click\", onClick);\n    }, []);\n\n    return (\n      <div className={styles.input}>\n        {labelName && <InputLabel labelId={labelId}>{labelName}</InputLabel>}\n        <div className={styles.inputWrapper} ref={root}>\n          <InputField\n            labelId={labelId}\n            hasError={hasError}\n            errorMessage={errorMessage}\n            ref={ref}\n            value={value}\n            onFocus={() => setOpen(true)}\n            onChange={(e) => setValue(e.target.value)}\n            {...rest}\n          />\n          {open && (\n            <ul className={styles.autocompleteField}>\n              {filteredList.map((item) => (\n                <li\n                  key={item.id}\n                  className={styles.autocompleteItem}\n                  onClick={() => handleItemClick(itemClickHandler, item)}\n                >\n                  {item.title}\n                </li>\n              ))}\n            </ul>\n          )}\n        </div>\n      </div>\n    );\n  },\n);\n\nexport default SearchInput;\n"],"names":["SearchInput","forwardRef","props","ref","labelName","hasError","errorMessage","searchingList","itemClickHandler","hasFilter","rest","labelId","uuidv4","open","setOpen","useState","value","setValue","filteredList","item","a","b","handleItemClick","cb","value2","root","useRef","useEffect","onClick","e","jsxs","styles","jsx","InputLabel","InputField"],"mappings":"4aAkBAA,EAAAC,EAAA,WAAoB,CAAAC,EAAAC,IAAA,CAEhB,KAAA,CAAM,UAAAC,EAAA,GACQ,SAAAC,EACZ,aAAAC,EACA,cAAAC,EACA,iBAAAC,EACA,UAAAC,EAAA,GACY,GAAAC,CACT,EAAAR,EAGLS,EAAA,SAAAC,EAAA,CAAA,GAEA,CAAAC,EAAAC,CAAA,EAAAC,EAAA,SAAA,EAAA,EAEA,CAAAC,EAAAC,CAAA,EAAAF,EAAA,SAAA,EAAA,EAEAG,EAAAT,EAAAF,EAAA,OAEOY,GAAAA,EAAA,MAAA,YAAA,EAAA,SAAA,OAAAH,CAAA,EAAA,aAAA,CAC8D,EAAA,KAAA,CAAAI,EAAAC,IAAAD,EAAA,MAAAC,EAAA,MAAA,EAAA,EAAA,EAAAd,EAKrE,eAAAe,EAAAC,EAAAC,EAAA,CAIE,MAAAD,EAAAC,CAAA,EACAP,EAAA,EAAA,EACAH,EAAA,EAAA,CAAa,CAGf,MAAAW,EAAAC,SAAA,IAAA,EAEAC,OAAAA,EAAAA,UAAA,IAAA,CACE,MAAAC,EAAAC,GAAA,CACEJ,GAAAA,EAAA,SAAA,CAAAA,EAAA,QAAA,SAAAI,EAAA,MAAA,GAKEf,EAAA,EAAA,CACF,EAEF,gBAAA,iBAAA,QAAAc,CAAA,EACA,IAAA,SAAA,oBAAA,QAAAA,CAAA,CAA0D,EAAA,CAAA,CAAA,EAG5DE,EAAAA,KAAA,MAAA,CAAA,UAAAC,EAAA,MAAA,SAAA,CAEK3B,GAAA4B,EAAA,IAAAC,EAAA,CAAA,QAAAtB,EAAA,SAAAP,EAAA,EAAsD0B,OAAA,MAAA,CAAA,UAAAC,EAAA,aAAA,IAAAN,EAAA,SAAA,CAErDO,EAAA,IAAAE,EAAC,CAAA,QAAAvB,EACC,SAAAN,EACA,aAAAC,EACA,IAAAH,EACA,MAAAa,EACA,QAAA,IAAAF,EAAA,EAAA,EAC2B,SAAA,GAAAG,EAAA,EAAA,OAAA,KAAA,EACa,GAAAP,CACpC,CAAA,EACNG,GAAAmB,EAAA,IAAA,KAAA,CAAA,UAAAD,EAAA,kBAAA,SAAAb,EAAA,IAAAC,GAAAa,EAAA,IAIM,KAAC,CAAA,UAAAD,EAAA,iBAEmB,QAAA,IAAAT,EAAAd,EAAAW,CAAA,EACmC,SAAAA,EAAA,KAE/C,EAAAA,EAAA,EAJI,CAAA,EAAA,CAOhB,EAAA,CAEJ,CAAA,CAAA,CACF,CAGN;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}