{"version":3,"file":"SearchInput.stories-23987193.js","sources":["../../src/components/ui/SearchInput/SearchInput.tsx"],"sourcesContent":["import { forwardRef, useEffect, useRef, useState } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport styles from \"./SearchInput.module.scss\";\nimport InputLabel from \"../InputLabel/InputLabel.tsx\";\nimport InputField, { InputFieldProps } from \"../InputField/InputField.tsx\";\n\nexport interface SearchingItem {\n  id: string;\n  name: string;\n}\n\nexport interface SearchInputProps extends InputFieldProps {\n  labelName?: string;\n  searchingList: SearchingItem[];\n  itemClickHandler: (e: SearchingItem) => void;\n  hasFilter?: boolean;\n}\n\nconst SearchInput = forwardRef<HTMLInputElement, SearchInputProps>(\n  (props, ref) => {\n    const {\n      labelName = \"\",\n      hasError,\n      errorMessage,\n      searchingList,\n      itemClickHandler,\n      hasFilter = true,\n      value = \"\",\n      ...rest\n    } = props;\n\n    const labelId = `label-${uuidv4()}`;\n\n    const [open, setOpen] = useState(false);\n\n    const filteredList = hasFilter\n      ? searchingList\n          .filter((item) =>\n            item.name.toLowerCase().includes(String(value).toLowerCase()),\n          )\n          .sort((a, b) => (a.name > b.name ? 1 : -1))\n      : searchingList;\n\n    async function handleItemClick(\n      cb: (e: SearchingItem) => void,\n      value: SearchingItem,\n    ) {\n      await cb(value);\n      setOpen(false);\n    }\n\n    const root = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n      const onClick = (e: MouseEvent) => {\n        if (\n          root &&\n          root.current &&\n          !root.current.contains(e.target as HTMLBodyElement)\n        ) {\n          setOpen(false);\n        }\n      };\n      document.addEventListener(\"click\", onClick);\n      return () => document.removeEventListener(\"click\", onClick);\n    }, []);\n\n    return (\n      <div className={styles.input}>\n        {labelName && <InputLabel labelId={labelId}>{labelName}</InputLabel>}\n        <InputField\n          labelId={labelId}\n          hasError={hasError}\n          errorMessage={errorMessage}\n          ref={ref}\n          value={value}\n          onFocus={() => setOpen(true)}\n          {...rest}\n        />\n        {open && (\n          <ul className={styles.autocompleteField}>\n            {filteredList.map((item) => (\n              <li\n                key={item.id}\n                className={styles.autocompleteItem}\n                onClick={() => handleItemClick(itemClickHandler, item)}\n              >\n                {item.name}\n              </li>\n            ))}\n          </ul>\n        )}\n      </div>\n    );\n  },\n);\n\nexport default SearchInput;\n"],"names":["SearchInput","forwardRef","props","ref","labelName","hasError","errorMessage","searchingList","itemClickHandler","hasFilter","value","rest","labelId","uuidv4","open","setOpen","useState","filteredList","item","a","b","handleItemClick","cb","value2","root","useRef","useEffect","onClick","e","jsxs","styles","jsx","InputLabel","InputField"],"mappings":"uWAkBAA,EAAAC,EAAA,WAAoB,CAAAC,EAAAC,IAAA,CAEhB,KAAA,CAAM,UAAAC,EAAA,GACQ,SAAAC,EACZ,aAAAC,EACA,cAAAC,EACA,iBAAAC,EACA,UAAAC,EAAA,GACY,MAAAC,EAAA,GACJ,GAAAC,CACL,EAAAT,EAGLU,EAAA,SAAAC,EAAA,CAAA,GAEA,CAAAC,EAAAC,CAAA,EAAAC,EAAA,SAAA,EAAA,EAEAC,EAAAR,EAAAF,EAAA,OAEOW,GAAAA,EAAA,KAAA,YAAA,EAAA,SAAA,OAAAR,CAAA,EAAA,aAAA,CAC6D,EAAA,KAAA,CAAAS,EAAAC,IAAAD,EAAA,KAAAC,EAAA,KAAA,EAAA,EAAA,EAAAb,EAKpE,eAAAc,EAAAC,EAAAC,EAAA,CAIE,MAAAD,EAAAC,CAAA,EACAR,EAAA,EAAA,CAAa,CAGf,MAAAS,EAAAC,SAAA,IAAA,EAEAC,OAAAA,EAAAA,UAAA,IAAA,CACE,MAAAC,EAAAC,GAAA,CACEJ,GAAAA,EAAA,SAAA,CAAAA,EAAA,QAAA,SAAAI,EAAA,MAAA,GAKEb,EAAA,EAAA,CACF,EAEF,gBAAA,iBAAA,QAAAY,CAAA,EACA,IAAA,SAAA,oBAAA,QAAAA,CAAA,CAA0D,EAAA,CAAA,CAAA,EAG5DE,EAAAA,KAAA,MAAA,CAAA,UAAAC,EAAA,MAAA,SAAA,CAEK1B,GAAA2B,EAAA,IAAAC,EAAA,CAAA,QAAApB,EAAA,SAAAR,EAAA,EAAsD2B,EAAA,IACvDE,EAAC,CAAA,QAAArB,EACC,SAAAP,EACA,aAAAC,EACA,IAAAH,EACA,MAAAO,EACA,QAAA,IAAAK,EAAA,EAAA,EAC2B,GAAAJ,CACvB,CAAA,EACNG,GAAAiB,EAAA,IAAA,KAAA,CAAA,UAAAD,EAAA,kBAAA,SAAAb,EAAA,IAAAC,GAAAa,EAAA,IAIM,KAAC,CAAA,UAAAD,EAAA,iBAEmB,QAAA,IAAAT,EAAAb,EAAAU,CAAA,EACmC,SAAAA,EAAA,IAE/C,EAAAA,EAAA,EAJI,CAAA,EAAA,CAOhB,CAAA,CAAA,CAEJ,CAGN;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}